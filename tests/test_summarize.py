import unittest
from report_MPC_less_subs import *

class TestClass(unittest.TestCase):

    def test_pull_site_lines(self):
        lines = ['K6378         C2015 09 03.39479403 16 28.04 +62 22 00.4          15.72R      K92',
                 'K6378         C2015 09 03.40479403 16 28.09 +62 22 01.4          15.77R      K92',
                 'K6378         C2015 09 03.41479403 16 28.14 +62 22 02.4          15.72R      K92',
                 'K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          15.74R      V37',
                 'K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          15.79R      V37',
                 'K6378         C2015 09 03.44479403 16 28.29 +62 22 05.4          15.69R      V37',
                 'K6378         C2015 09 03.45479403 16 28.34 +62 22 06.4          15.73R      V37',
                ]
        expected_lines = ['K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          15.74R      V37',
                          'K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          15.79R      V37',
                          'K6378         C2015 09 03.44479403 16 28.29 +62 22 05.4          15.69R      V37',
                          'K6378         C2015 09 03.45479403 16 28.34 +62 22 06.4          15.73R      V37',
                         ]

        result = pull_site_lines(lines, 'V37', '2015', '09', '03')
        self.assertEqual (result, expected_lines)

    def test_pull_site_lines_for_correct_date(self):
        lines = ['K6378         C2015 09 03.39479403 16 28.04 +62 22 00.4          15.72R      K92',
                 'K6378         C2015 09 03.40479403 16 28.09 +62 22 01.4          15.77R      K92',
                 'K6378         C2015 09 03.41479403 16 28.14 +62 22 02.4          15.72R      K92',
                 'K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          15.74R      V37',
                 'K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          15.79R      V37',
                 'K6378         C2015 09 03.44479403 16 28.29 +62 22 05.4          15.69R      V37',
                 'K6378         C2015 09 03.45479403 16 28.34 +62 22 06.4          15.73R      V37',
                 'K6378         C2015 10 03.44479403 16 28.29 +62 22 05.4          15.69R      V37',
                 'K6378         C2015 10 03.45479403 16 28.34 +62 22 06.4          15.73R      V37',
                ]
        expected_lines = ['K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          15.74R      V37',
                          'K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          15.79R      V37',
                          'K6378         C2015 09 03.44479403 16 28.29 +62 22 05.4          15.69R      V37',
                          'K6378         C2015 09 03.45479403 16 28.34 +62 22 06.4          15.73R      V37',
                         ]

        result = pull_site_lines(lines, 'V37', '2015', '09', '03')
        self.assertEqual (result, expected_lines)

    def test_too_many_lines(self):
        lines = ['K6378         C2015 09 03.39479403 16 28.04 +62 22 00.4          15.72R      V37',
                 'K6378         C2015 09 03.40479403 16 28.09 +62 22 01.4          15.77R      V37',
                 'K6378         C2015 09 03.41479403 16 28.14 +62 22 02.4          15.72R      V37',
                 'K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          15.74R      V37',
                 'K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          15.79R      V37',
                 'K6378         C2015 09 03.44479403 16 28.29 +62 22 05.4          15.69R      V37',
                 'K6378         C2015 09 03.45479403 16 28.34 +62 22 06.4          15.73R      V37',
                 'K6378         C2015 09 03.46479403 16 28.39 +62 22 07.4          15.62R      V37',
                 'K6378         C2015 09 03.47479403 16 28.44 +62 22 08.4          15.69R      V37',
                 'K6378         C2015 09 03.48479403 16 28.49 +62 22 09.4          15.70R      V37',
                 'K6378         C2015 09 03.49479403 16 28.54 +62 22 10.4          15.77R      V37',
                 'K6378         C2015 09 03.50479403 16 28.59 +62 22 11.4          15.72R      V37',
                 'K6378         C2015 09 03.51479403 16 28.64 +62 22 12.4          15.66R      V37',
                 'K6378         C2015 09 03.52479403 16 28.69 +62 22 13.4          15.76R      V37',
                 'K6378         C2015 09 03.53479403 16 28.74 +62 22 14.4          15.73R      V37',
                 'K6378         C2015 09 03.54479403 16 28.79 +62 22 15.4          15.72R      V37',
                 'K6378         C2015 09 03.55479403 16 28.84 +62 22 16.4          15.79R      V37',
                 'K6378         C2015 09 03.56479403 16 28.89 +62 22 17.4          15.76R      V37',
                 'K6378         C2015 09 03.57479403 16 28.94 +62 22 18.4          15.80R      V37',
                 'K6378         C2015 09 03.58479403 16 28.99 +62 22 19.4          15.78R      V37',
                 'K6378         C2015 09 03.59479403 16 29.04 +62 22 20.4          15.81R      V37',
                 'K6378         C2015 09 03.60479403 16 29.09 +62 22 21.4          15.76R      V37',
                 'K6378         C2015 09 03.61479403 16 29.14 +62 22 22.4          15.77R      V37',
                 'K6378         C2015 09 03.62479403 16 29.19 +62 22 23.4          15.74R      V37',
                 ]
        expected_lines = [['K6378         C2015 09 03.40479403 16 28.09 +62 22 01.4          ', 15.8, 'R      V37'],
                          ['K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.44479403 16 28.29 +62 22 05.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.46479403 16 28.39 +62 22 07.4          ', 15.6, 'R      V37'],
                          ['K6378         C2015 09 03.48479403 16 28.49 +62 22 09.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.50479403 16 28.59 +62 22 11.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.52479403 16 28.69 +62 22 13.4          ', 15.8, 'R      V37'],
                          ['K6378         C2015 09 03.54479403 16 28.79 +62 22 15.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.56479403 16 28.89 +62 22 17.4          ', 15.8, 'R      V37'],
                          ['K6378         C2015 09 03.58479403 16 28.99 +62 22 19.4          ', 15.8, 'R      V37'],
                         ]
        result = summarize_MPC_report(lines)
        self.assertEqual (result, expected_lines)

    def test_too_few_lines(self):
        lines = ['K6378         C2015 09 03.39479403 16 28.04 +62 22 00.4          15.72R      V37',
                 'K6378         C2015 09 03.40479403 16 28.09 +62 22 01.4          15.77R      V37',
                 'K6378         C2015 09 03.41479403 16 28.14 +62 22 02.4          15.72R      V37',
                 'K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          15.74R      V37',
                 'K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          15.79R      V37',

                 ]
        expected_lines = [['K6378         C2015 09 03.39479403 16 28.04 +62 22 00.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.40479403 16 28.09 +62 22 01.4          ', 15.8, 'R      V37'],
                          ['K6378         C2015 09 03.41479403 16 28.14 +62 22 02.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.42479403 16 28.19 +62 22 03.4          ', 15.7, 'R      V37'],
                          ['K6378         C2015 09 03.43479403 16 28.24 +62 22 04.4          ', 15.8, 'R      V37'],
                         ]
        result = summarize_MPC_report(lines)
        self.assertEqual (result, expected_lines)

